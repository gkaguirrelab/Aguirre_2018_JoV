
% Digitized from Mathur 2013 figure 8 using the web plot digitizer
% -alpha by refraction error
mathurData = [   -4.9433   -4.2966   -1.0632   -1.8460   -2.5721   -3.1280   -4.2399   -2.6856   -1.7893   -1.4716   -0.0648    0.1961    0.0032   -0.2690    0.0032    0.6726    0.5478    0.5932   -0.5413   -0.5413   -0.2010   -0.1783    0.6726    0.8314    0.1507    0.0600   -0.0308    0.1167    0.3436    2.1815
   -0.8299   -2.7801   -1.5353   -3.0705   -3.3402   -3.9004   -6.8672   -6.4938   -3.6722   -3.6515   -4.0664   -4.3361   -4.5436   -4.7303   -5.2075   -5.1660   -5.0622   -5.0207   -6.1203   -6.4730   -5.9959   -6.3071   -6.1826   -6.4730   -7.1369   -7.3237   -7.5519   -7.5934   -8.4855   -7.5726];
% Convert the -alpha to positive alpha
mathurData(2,:) = -mathurData(2,:);

% Hashemi 2010
% kapa by refraction error
% Data provided by the corresponding author Akbar Fotouhi on April 23,
% 2018. From the study, there were 279 subjects who had refractive error
% determined under cycloplegia. These data are plotted here.
hashemiData = [6.75	5.75	4.38	4	3.88	3.75	3.38	3.13	3.13	2.88	2.63	2.63	2.5	2.38	2.25	2.25	2.25	2.13	2.13	1.88	1.88	1.75	1.75	1.75	1.63	1.63	1.63	1.63	1.5	1.5	1.5	1.5	1.5	1.5	1.5	1.5	1.38	1.38	1.38	1.38	1.38	1.38	1.38	1.38	1.25	1.25	1.25	1.25	1.25	1.25	1.13	1.13	1.13	1.13	1.13	1.13	1.13	1.13	1.13	1.13	1.13	1	1	1	1	1	1	1	1	1	1	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.88	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.75	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.63	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.38	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.25	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0.13	0	0	0	0	0	0	0	0	-0.13	-0.13	-0.13	-0.13	-0.25	-0.25	-0.25	-0.25	-0.25	-0.25	-0.37	-0.38	-0.38	-0.5	-0.5	-0.5	-0.5	-0.5	-0.5	-0.63	-0.63	-0.63	-0.75	-0.75	-0.75	-0.75	-0.75	-0.75	-0.75	-0.88	-0.88	-0.88	-0.88	-0.88	-0.88	-0.88	-0.88	-0.94	-1	-1	-1.13	-1.13	-1.25	-1.25	-1.25	-1.25	-1.38	-1.38	-1.5	-1.5	-1.5	-1.75	-1.88	-1.88	-2	-2.13	-2.63	-2.75	-2.75	-2.88	-3.13	-3.25	-3.25	-3.38	-3.75	-3.88	-3.88	-4.13	-4.13	-4.88	-5.25	-5.25	-5.38	-5.5	-6.13	-6.63	-8.13	-8.63	-9.25	-15.38
8.29	3.09	5.38	6.83	7.15	4.69	4.06	4.1	7.76	4.87	5.05	3.36	6.12	5.11	7.14	4.58	5.33	5.75	5.3	6.85	4.79	4.08	3.66	6.55	5.5	4.82	5.02	4.83	5.09	7.66	3.84	6.09	6.4	4.99	6.31	3.22	5.81	7.11	4.24	5.54	2.1	6.88	4.52	4.18	6.96	6.58	5.56	6.34	6.18	4.86	5.43	5.82	6.14	6.48	6.06	6.11	4.17	5.29	6.68	6.08	6.28	7.13	5.85	7.04	3.7	7.31	5.54	5.11	4.78	6.04	5.9	8.06	6.88	3.32	3.32	4.14	5.54	4.68	5.13	5.36	6.41	5.29	5.63	3.04	3.96	5.92	5.73	5.3	6.19	4.42	4.94	6.49	5.72	4.74	4.57	3.46	6.07	4.91	5.2	5.5	4.5	6.98	5.73	10.75	6.79	5.82	2.71	3.49	7.84	5.9	4.78	2.71	4.93	6.52	5.95	5.21	5.23	4.87	5.59	6.04	6.77	5.67	5.47	5.26	4.49	3.78	6.7	5.36	6.14	7.4	5.14	5.79	4.04	5.95	6.69	4.7	7.52	6.73	5.83	5.81	5.43	6.65	6.49	5.63	5.24	3.97	5.96	6.19	7.67	6.26	7.69	5.83	6.05	5.47	6.41	3.72	5.41	4.43	7.02	5.51	4.31	5.69	6	6.07	4.76	8.27	5.23	4.56	5.85	7.39	6.15	4.9	6.1	5.63	6.13	6.49	6.19	6.31	5.34	6.36	4.42	6.86	5.98	6.63	3.19	4.56	4.81	9.1	4.96	5.57	4	5.8	6.26	4.87	6.49	3.58	4.38	5.71	6.86	4.98	5.18	5.51	6.86	5.5	5.79	5.97	7.06	5.45	6.5	4.96	6.27	4.43	4.78	7.09	5.66	4.88	3.5	6.18	3.49	6.24	5.6	5.69	5.69	7.18	4.81	5.87	5.88	7.65	5.27	7.15	4.66	5.95	5.88	5.74	6.99	5.49	4.01	7.02	4.55	6.07	4.2	4.88	4.54	6.62	7.71	5.57	5.48	1.11	5.11	6.43	6.68	6.19	3.73	7.88	4.49	5.42	5.18	5.92	4.75	6.03	4.58	6.61	6.04	2.94	2.35	4.06	3.48	3.86	4.16	5.4	6.65	3.92	5.2	3.3	3.97	0.94	2.1	5.08	2.37];

% Tabernero 2007 alpha by axial length
taberneroData = [    22.4046   22.6534   22.2886   22.2222   23.7313   24.6766   25.2736   24.4444   22.4378   22.2554   23.0680   23.0348   23.7479   24.5937   24.7761   25.4726   25.7877   27.8773
    8.8219    8.4110    7.5342    6.7123    7.1233    6.5205    6.1096    6.0274    5.6438    4.7945    4.1644    4.0274    3.9452    3.7260    4.8219    4.2192    3.7260    2.0274];

% Convert axial length in Tabernero to spherical error using the Atchison
% 2006 Eq19
ametropiaFromLength = @(x) (23.58 - x)./0.299;
taberneroData(1,:) = ametropiaFromLength(taberneroData(1,:));

figure

plot(mathurData(1,:),mathurData(2,:),'ok');
hold on
plot(hashemiData(1,:),hashemiData(2,:),'or');
plot(taberneroData(1,:),taberneroData(2,:),'ob');

% Add our model fit
sphericalAmetropias = -10:1:5;
clear alphaAzi alphaEle
for aa = 1:length(sphericalAmetropias)
    eye = modelEyeParameters('sphericalAmetropia',sphericalAmetropias(aa));
    alphaAzi(aa)= eye.axes.visual.degField(1);
    alphaEle(aa)= eye.axes.visual.degField(2);
end
plot(sphericalAmetropias,alphaAzi,'-r')

% Add the Tabernero model
sphericalAmetropias = -10:1:5;
clear alphaAzi alphaEle
for aa = 1:length(sphericalAmetropias)
    % This visual axis yeild an azimuth alpha of 5 deg in the
    % emmetropic eye, matching the Tabernero model
    eye = modelEyeParameters('sphericalAmetropia',sphericalAmetropias(aa),'visualAxisDegRetina',[7.015 0 0]);
    alphaAzi(aa)= eye.axes.visual.degField(1);
    alphaEle(aa)= eye.axes.visual.degField(2);
end
plot(sphericalAmetropias,alphaAzi,':b')

ylim([0 12]);
xlim([-20 10]);
xlabel('spherical refractive error [diopters]');
ylabel('kappa or alpha [deg]');